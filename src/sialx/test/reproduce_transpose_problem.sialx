sial reproduce_transpose_problem

predefined  int baocc  # begin of occupied orbital segment range (alpha)
predefined  int eaocc  # end occupied orbital segment range (alpha)
predefined  int bavirt  # begin of virtual orbital segment range (alpha)
predefined  int eavirt  # end of virtual orbital segment range (alpha)
special fill_block_sequential wr
special print_block r


      moaindex i = baocc, eaocc
      moaindex i1= baocc, eaocc
 
      moaindex a = bavirt, eavirt
      moaindex a1= bavirt, eavirt
      distributed Vaiai(a,i1,a1,i) 
      temp Taiai(a,i1,a1,i) 
      temp T1aiai(a,i1,a1,i)
      
      scalar etemp
      scalar esumaa
      
      
      etemp = 0.0
      esumaa = 0.0
      create Vaiai
         
      do i
      pardo a, a1, i1
              execute fill_block_sequential Vaiai(a,i1,a1,i) 42.0
              execute fill_block_sequential Vaiai(a1,i1,a,i) 21.0
      endpardo a, a1, i1  
      enddo i
      
      do i
              PARDO a, a1, i1
 
              get                        Vaiai(a,i1,a1,i)
              get                        Vaiai(a1,i1,a,i)
              execute fill_block_sequential Vaiai(a,i1,a1,i) 42.0
              execute fill_block_sequential Vaiai(a1,i1,a,i) 42.0
              Taiai(a,i1,a1,i)         = Vaiai(a,i1,a1,i)
              T1aiai(a,i1,a1,i)        = Vaiai(a1,i1,a,i)
              execute print_block Vaiai(a1,i1,a,i)
              execute print_block T1aiai(a,i1,a1,i) 
              Taiai(a,i1,a1,i)        *= 2.0
              Taiai(a,i1,a1,i)        -= T1aiai(a,i1,a1,i)
#
# Compute the denominator 
 #             execute energy_denominator_rhf Taiai(a,i1,a1,i) fock_a 
              etemp                    = Taiai(a,i1,a1,i)*Vaiai(a,i1,a1,i)
              esumaa                  += etemp
              print_scalar etemp 
 
        ENDPARDO a, a1, i1
        enddo i
        print_scalar etemp 
        sip_barrier
        delete Vaiai #(*,*,*,i)
        
        
 endsial reproduce_transpose_problem